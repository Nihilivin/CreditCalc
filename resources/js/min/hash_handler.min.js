waitFor(window,"Base",function(){function e(){this._private={propIndex:0,propTables:{decoded:[],encoded:[]},enums:{}}}e.encodedBase={fragment:new Base(":!$&'()*+,;=-._~@/?ABCDEFGHIJKLMNOPQRSTUVWXYabcdefghijklmnopqrstuvwxyz0123456789")};var n={num:new Base(":1234567890,.")};n.alphanum=new Base(n.num.set+"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),n.nested=new Base(n.alphanum.set+"{}[]"),n.full=new Base(n.nested.set+"\\/;*!&~\"#'-|_`@="),e.decodedBase=n,e.prototype.registerProperties=function(e){var n,o,r=this._private;for(n in e)hop(e,n)&&(o=e[n],r.propTables.decoded.push(n),r.propTables.encoded.push(r.propIndex),isNA(o)||"Array"!=o.constructor.name||(r.enums[r.propIndex]=o),r.propIndex++)},e.prototype.encode=function(n,o,r){n=Object(n);var s,d,t,a=this._private,i={},c=a.propTables.encoded,p=a.propTables.decoded;Object.keys(a.enums);for(h in n)hop(n,h)&&(d=-1!=(s=p.indexOf(h))?c[s]:h,t=n[h],t=isNA(s=a.enums[d])?t:-1!=(s=s.indexOf(t))?s:t,t===!0?t=1:t===!1&&(t=0),i[d]=t);var f=JSON.stringify(i);f=f.slice(1).slice(0,-1).replace(/"/g,""),f=f.replace(/^0:/,"");var l=f;if(r=r===!0,!r){var h,u=!1,g=0,m=f.length;for(h in e.decodedBase){for(;m>g&&-1!=e.decodedBase[h].set.indexOf(f[g]);g++);if(g===m){u=!0,f=e.decodedBase[h].convert(e.encodedBase.fragment,f);break}}if(!u)throw'Unable to super-encode the following string: "'+f+'"';var y=Object.keys(e.decodedBase).indexOf(h);f=e.encodedBase.fragment.set[y]+f}if(console.info("String was encoded from "+JSON.stringify(l)+" to "+JSON.stringify(f)+": diff of "+(f.length-l.length)+" chars."),"undefined"==typeof o||o===!0)try{history.pushState?history.pushState(null,null,"#"+f):location.hash="#"+f}catch(B){console.error("Could not change hash:",B)}return f},e.prototype.decode=function(n,o){if(isNA(n)&&(n=location.hash.slice(1)),o=o===!0,!o){var r=n[0],s=e.encodedBase.fragment.set.indexOf(r),d=Object.keys(e.decodedBase)[s],t=e.decodedBase[d];n=n.slice(1);try{n=e.encodedBase.fragment.convert(t,n)}catch(a){return console.error("Fragment string not properly encoded. ",n),{}}}n.indexOf(",")<n.indexOf(":")&&(n="0:"+n),n="{"+n+"}",n=n.replace(/(\{|,)([^:]+)|([a-zA-Z]+)/g,'$1"$2$3"');var c;try{c=JSON.parse(n)}catch(a){return console.error("Could not parse decoded from string. JSON was",n),{}}var p,f,n,l=this._private,h={},u=l.propTables.encoded,g=l.propTables.decoded;Object.keys(l.enums);for(i in c)hop(c,i)&&(f=-1!=(p=u.indexOf(parseInt(i)))?g[p]:i,n=c[i],n=isNA(p=l.enums[i])?n:(p=p[n])?p:n,n===!0?n=1:n===!1&&(n=0),h[f]=n);return h},window.HashHandler=e});